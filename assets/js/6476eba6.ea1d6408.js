"use strict";(self.webpackChunkjalapeno=self.webpackChunkjalapeno||[]).push([[827],{351:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>o});var a=n(5893),r=n(1151);const t={sidebar_position:3,slug:"/usage/",title:"Usage"},s="Usage [WIP]",l={id:"usage",title:"Usage",description:"Getting started",source:"@site/docs/usage.md",sourceDirName:".",slug:"/usage/",permalink:"/jalapeno/usage/",draft:!1,unlisted:!1,editUrl:"https://github.com/futurice/jalapeno/tree/main/docs/site/docs/usage.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,slug:"/usage/",title:"Usage"},sidebar:"tutorialSidebar",previous:{title:"Installation",permalink:"/jalapeno/installation/"},next:{title:"API Reference",permalink:"/jalapeno/api/"}},c={},o=[{value:"Getting started",id:"getting-started",level:2},{value:"Templating",id:"templating",level:2},{value:"Variables",id:"variables",level:2},{value:"Variable types",id:"variable-types",level:3},{value:"Validation",id:"validation",level:3},{value:"Using recipes in Container Registry",id:"using-recipes-in-container-registry",level:2},{value:"Pushing a recipe to Container registry",id:"pushing-a-recipe-to-container-registry",level:3},{value:"Executing a recipe from Container registry",id:"executing-a-recipe-from-container-registry",level:3},{value:"Checking updates for a recipe",id:"checking-updates-for-a-recipe",level:3}];function d(e){const i={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.h1,{id:"usage-wip",children:"Usage [WIP]"}),"\n",(0,a.jsx)(i.h2,{id:"getting-started",children:"Getting started"}),"\n",(0,a.jsxs)(i.p,{children:["To get started with Jalapeno, you need to install the CLI tool. You can find the installation instructions ",(0,a.jsx)(i.a,{href:"/installation",children:"here"}),"."]}),"\n",(0,a.jsxs)(i.p,{children:["Then you can bootstrap a new ",(0,a.jsx)(i.em,{children:"recipe"})," (aka template) by running:"]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-bash",children:"jalapeno create my-recipe\n"})}),"\n",(0,a.jsxs)(i.p,{children:["After this you should have a new folder called ",(0,a.jsx)(i.code,{children:"my-recipe"})," with the following structure:"]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{children:"my-recipe\n\u251c\u2500\u2500 recipe.yml\n\u251c\u2500\u2500 templates\n\u2502   \u2514\u2500\u2500 README.md\n\u2514\u2500\u2500 tests\n    \u2514\u2500\u2500 defaults\n        \u251c\u2500\u2500 test.yml\n        \u2514\u2500\u2500 files\n            \u2514\u2500\u2500 README.md\n"})}),"\n",(0,a.jsxs)(i.p,{children:["The ",(0,a.jsx)(i.code,{children:"templates"})," directory contains the templates which will be rendered to the project directory. You can add and edit files there or you can already ",(0,a.jsx)(i.em,{children:"execute the recipe"})," (render the templates) to your project directory by running:"]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-bash",children:"mkdir my-project\njalapeno execute my-recipe -d my-project\n"})}),"\n",(0,a.jsxs)(i.admonition,{type:"tip",children:[(0,a.jsx)(i.p,{children:"You can also execute any of the examples from the Jalapeno repository, for example:"}),(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-bash",children:"git clone git@github.com:futurice/jalapeno.git\njalapeno execute ./jalapeno/examples/variable-types -d my-project\n"})}),(0,a.jsx)(i.p,{children:"Or execute them directly from GitHub Container Registry:"}),(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-bash",children:"jalapeno execute oci://ghcr.io/futurice/jalapeno/examples/variable-types:0.0.0 -d my-project\n"})})]}),"\n",(0,a.jsx)(i.p,{children:"After this, the project directory should have the following files:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{children:"my-project\n\u251c\u2500\u2500 .jalapeno\n\u2502   \u2514\u2500\u2500 sauces.yml\n\u2514\u2500\u2500 README.md\n"})}),"\n",(0,a.jsxs)(i.p,{children:["The ",(0,a.jsx)(i.code,{children:".jalapeno"})," directory contains files which Jalapeno uses internally. For example ",(0,a.jsx)(i.code,{children:"sauces.yml"})," is Jalapeno metadata file which contains information about the ",(0,a.jsx)(i.em,{children:"sauces"})," (aka executed recipes). This file is used to check for updates for the recipes later."]}),"\n",(0,a.jsx)(i.p,{children:"The rest of the files are rendered from the templates. You can edit the templates and execute the recipe again to update the files."}),"\n",(0,a.jsx)(i.h2,{id:"templating",children:"Templating"}),"\n",(0,a.jsxs)(i.p,{children:["Templates are done by using ",(0,a.jsx)(i.a,{href:"https://pkg.go.dev/text/template",children:"Go templates"}),"."]}),"\n",(0,a.jsx)(i.p,{children:"The following context is available on the templates:"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.code,{children:".Recipe"}),": Metadata object of the recipe","\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.code,{children:".Recipe.APIVersion"}),": The API version which the recipe file uses"]}),"\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.code,{children:".Recipe.Name"}),": The name of the recipe"]}),"\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.code,{children:".Recipe.Version"}),": The current version of the recipe"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.code,{children:".ID"}),": UUID which is generated after the first execution of the recipe. It will keep its value over upgrades. Can be used to generate unique pseudo-random values which stays the same over the upgrades, for example ",(0,a.jsx)(i.code,{children:"my-resource-{{ sha1sum .ID | trunc 5 }}"})]}),"\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.code,{children:".Variables"}),": Object which contains the values of the variables defined for the recipe. Example: ",(0,a.jsx)(i.code,{children:"{{ .Variables.FOO }}"})]}),"\n"]}),"\n",(0,a.jsx)(i.h2,{id:"variables",children:"Variables"}),"\n",(0,a.jsxs)(i.p,{children:["Recipe variables let you define values which user need to provide to be able to render the tempaltes. Variables are defined in the ",(0,a.jsx)(i.code,{children:"recipe.yml"})," file. You can check schema ",(0,a.jsx)(i.a,{href:"/api#variable",children:"here"}),"."]}),"\n",(0,a.jsx)(i.h3,{id:"variable-types",children:"Variable types"}),"\n",(0,a.jsx)(i.p,{children:"Recipe variables supports the following types:"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/futurice/jalapeno/blob/main/examples/variable-types/recipe.yml#L9-L11",children:"String"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/futurice/jalapeno/blob/main/examples/variable-types/recipe.yml#L13-L15",children:"Boolean"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/futurice/jalapeno/blob/main/examples/variable-types/recipe.yml#L20-L22",children:"Select (predefined options)"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/futurice/jalapeno/blob/main/examples/variable-types/recipe.yml#L29-L38",children:"Table"})}),"\n"]}),"\n",(0,a.jsxs)(i.p,{children:["You can see examples of all the possible variables in the ",(0,a.jsx)(i.a,{href:"https://github.com/futurice/jalapeno/blob/main/examples/variable-types/recipe.yml",children:"example recipe"}),"."]}),"\n",(0,a.jsx)(i.admonition,{type:"note",children:(0,a.jsxs)(i.p,{children:["If you need to use numbers in the templates, you can use the ",(0,a.jsx)(i.code,{children:"atoi"})," function to convert a string variable to integer: ",(0,a.jsx)(i.code,{children:"{{ .Variables.FOO | atoi }}"})]})}),"\n",(0,a.jsx)(i.h3,{id:"validation",children:"Validation"}),"\n",(0,a.jsxs)(i.p,{children:["Variables can be validated by defining ",(0,a.jsx)(i.a,{href:"/api#variable",children:(0,a.jsx)(i.code,{children:"validators"})})," property for the variable. Validators support regular expression pattern matching."]}),"\n",(0,a.jsx)(i.h2,{id:"using-recipes-in-container-registry",children:"Using recipes in Container Registry"}),"\n",(0,a.jsx)(i.h3,{id:"pushing-a-recipe-to-container-registry",children:"Pushing a recipe to Container registry"}),"\n",(0,a.jsx)(i.h3,{id:"executing-a-recipe-from-container-registry",children:"Executing a recipe from Container registry"}),"\n",(0,a.jsx)(i.h3,{id:"checking-updates-for-a-recipe",children:"Checking updates for a recipe"}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.code,{children:"jalapeno check"})})]})}function h(e={}){const{wrapper:i}={...(0,r.a)(),...e.components};return i?(0,a.jsx)(i,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);